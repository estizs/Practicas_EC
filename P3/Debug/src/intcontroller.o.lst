   1              		.cpu arm7tdmi
   2              		.fpu softvfp
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 6
  10              		.eabi_attribute 18, 4
  11              		.file	"intcontroller.c"
  21              	.Ltext0:
  22              		.file 1 "../src/intcontroller.c"
 1701              		.align	2
 1702              		.global	ic_init
 1704              	ic_init:
 1705              	.LFB0:
   1:../src/intcontroller.c **** /*-------------------------------------------------------------------
   2:../src/intcontroller.c **** **
   3:../src/intcontroller.c **** **  Fichero:
   4:../src/intcontroller.c **** **    intcontroller.c  3/3/2016
   5:../src/intcontroller.c **** **
   6:../src/intcontroller.c **** **    Estructura de Computadores
   7:../src/intcontroller.c **** **    Dpto. de Arquitectura de Computadores y AutomÃ¡tica
   8:../src/intcontroller.c **** **    Facultad de InformÃ¡tica. Universidad Complutense de Madrid
   9:../src/intcontroller.c **** **
  10:../src/intcontroller.c **** **  PropÃ³sito:
  11:../src/intcontroller.c **** **    Contiene las implementaciÃ³n del mÃ³dulo intcontroller
  12:../src/intcontroller.c **** **
  13:../src/intcontroller.c **** **-----------------------------------------------------------------*/
  14:../src/intcontroller.c **** 
  15:../src/intcontroller.c **** /*--- ficheros de cabecera ---*/
  16:../src/intcontroller.c **** #include "44b.h"
  17:../src/intcontroller.c **** #include "intcontroller.h"
  18:../src/intcontroller.c **** 
  19:../src/intcontroller.c **** void ic_init(void)
  20:../src/intcontroller.c **** {
 1706              		.loc 1 20 0
 1707              		.cfi_startproc
 1708              		@ Function supports interworking.
 1709              		@ args = 0, pretend = 0, frame = 0
 1710              		@ frame_needed = 1, uses_anonymous_args = 0
 1711 0000 0DC0A0E1 		mov	ip, sp
 1712              	.LCFI0:
 1713              		.cfi_def_cfa_register 12
 1714 0004 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 1715 0008 04B04CE2 		sub	fp, ip, #4
 1716              		.cfi_offset 14, -8
 1717              		.cfi_offset 13, -12
 1718              		.cfi_offset 11, -16
 1719              	.LCFI1:
 1720              		.cfi_def_cfa 11, 4
  21:../src/intcontroller.c **** 	/* Configuración por defecto del controlador de interrupciones:
  22:../src/intcontroller.c **** 	 *    Lineas IRQ y FIQ no habilitadas
  23:../src/intcontroller.c **** 	 *    Linea IRQ en modo no vectorizado
  24:../src/intcontroller.c **** 	 *    Todo por la línea IRQ
  25:../src/intcontroller.c **** 	 *    Todas las interrupciones enmascaradas
  26:../src/intcontroller.c **** 	 **/
  27:../src/intcontroller.c **** 	rINTMOD = 0x0; // Configura las linas como de tipo IRQ
 1721              		.loc 1 27 0
 1722 000c 28309FE5 		ldr	r3, .L2
 1723 0010 0020A0E3 		mov	r2, #0
 1724 0014 002083E5 		str	r2, [r3, #0]
  28:../src/intcontroller.c **** 	rINTCON = 0x7; // IRQ y FIQ enmascaradas, IRQ en modo no vectorizado
 1725              		.loc 1 28 0
 1726 0018 1E36A0E3 		mov	r3, #31457280
 1727 001c 0720A0E3 		mov	r2, #7
 1728 0020 002083E5 		str	r2, [r3, #0]
  29:../src/intcontroller.c **** 	rINTMSK = ~(0x0); // Enmascara todas las lineas
 1729              		.loc 1 29 0
 1730 0024 14309FE5 		ldr	r3, .L2+4
 1731 0028 0020E0E3 		mvn	r2, #0
 1732 002c 002083E5 		str	r2, [r3, #0]
  30:../src/intcontroller.c **** }
 1733              		.loc 1 30 0
 1734 0030 0CD04BE2 		sub	sp, fp, #12
 1735 0034 00689DE8 		ldmfd	sp, {fp, sp, lr}
 1736 0038 1EFF2FE1 		bx	lr
 1737              	.L3:
 1738              		.align	2
 1739              	.L2:
 1740 003c 0800E001 		.word	31457288
 1741 0040 0C00E001 		.word	31457292
 1742              		.cfi_endproc
 1743              	.LFE0:
 1745              		.align	2
 1746              		.global	ic_conf_irq
 1748              	ic_conf_irq:
 1749              	.LFB1:
  31:../src/intcontroller.c **** 
  32:../src/intcontroller.c **** int ic_conf_irq(enum enable st, enum int_vec vec)
  33:../src/intcontroller.c **** {
 1750              		.loc 1 33 0
 1751              		.cfi_startproc
 1752              		@ Function supports interworking.
 1753              		@ args = 0, pretend = 0, frame = 16
 1754              		@ frame_needed = 1, uses_anonymous_args = 0
 1755 0044 0DC0A0E1 		mov	ip, sp
 1756              	.LCFI2:
 1757              		.cfi_def_cfa_register 12
 1758 0048 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 1759 004c 04B04CE2 		sub	fp, ip, #4
 1760              		.cfi_offset 14, -8
 1761              		.cfi_offset 13, -12
 1762              		.cfi_offset 11, -16
 1763              	.LCFI3:
 1764              		.cfi_def_cfa 11, 4
 1765 0050 10D04DE2 		sub	sp, sp, #16
 1766 0054 0020A0E1 		mov	r2, r0
 1767 0058 0130A0E1 		mov	r3, r1
 1768 005c 15204BE5 		strb	r2, [fp, #-21]
 1769 0060 16304BE5 		strb	r3, [fp, #-22]
  34:../src/intcontroller.c **** 	int conf = rINTCON;
 1770              		.loc 1 34 0
 1771 0064 1E36A0E3 		mov	r3, #31457280
 1772 0068 003093E5 		ldr	r3, [r3, #0]
 1773 006c 10300BE5 		str	r3, [fp, #-16]
  35:../src/intcontroller.c **** 
  36:../src/intcontroller.c **** 	if (st != ENABLE && st != DISABLE)
 1774              		.loc 1 36 0
 1775 0070 15305BE5 		ldrb	r3, [fp, #-21]	@ zero_extendqisi2
 1776 0074 010053E3 		cmp	r3, #1
 1777 0078 0400000A 		beq	.L5
 1778              		.loc 1 36 0 is_stmt 0 discriminator 1
 1779 007c 15305BE5 		ldrb	r3, [fp, #-21]	@ zero_extendqisi2
 1780 0080 000053E3 		cmp	r3, #0
 1781 0084 0100000A 		beq	.L5
  37:../src/intcontroller.c **** 		return -1;
 1782              		.loc 1 37 0 is_stmt 1
 1783 0088 0030E0E3 		mvn	r3, #0
 1784 008c 1A0000EA 		b	.L6
 1785              	.L5:
  38:../src/intcontroller.c **** 
  39:../src/intcontroller.c **** 	if (vec == VEC)
 1786              		.loc 1 39 0
 1787 0090 16305BE5 		ldrb	r3, [fp, #-22]	@ zero_extendqisi2
 1788 0094 000053E3 		cmp	r3, #0
 1789 0098 0300001A 		bne	.L7
  40:../src/intcontroller.c **** 		//COMPLETAR: poner la linea IRQ en modo vectorizado
  41:../src/intcontroller.c **** 		// bit[2] = 0 => habilitar modo vectorizado
  42:../src/intcontroller.c **** 		// bit[1] = 1 => deshabilitar línea IRQ
  43:../src/intcontroller.c **** 		// bit[0] = 1 => deshabilitar línea FIQ
  44:../src/intcontroller.c **** 		// 0x1 << 2 = 100 => ~(0x1 << 2) = 011
  45:../src/intcontroller.c **** 		// 111 & 011 = 011
  46:../src/intcontroller.c **** 		conf = conf & ~(0x1 << 2);
 1790              		.loc 1 46 0
 1791 009c 10301BE5 		ldr	r3, [fp, #-16]
 1792 00a0 0430C3E3 		bic	r3, r3, #4
 1793 00a4 10300BE5 		str	r3, [fp, #-16]
 1794 00a8 050000EA 		b	.L8
 1795              	.L7:
  47:../src/intcontroller.c **** 
  48:../src/intcontroller.c **** 	else {
  49:../src/intcontroller.c **** 		//COMPLETAR: poner la linea IRQ en modo no vectorizado
  50:../src/intcontroller.c **** 		// bit[2] = 1
  51:../src/intcontroller.c **** 		// bit[1] = 0
  52:../src/intcontroller.c **** 		// bit[0] = 1
  53:../src/intcontroller.c **** 		// 101 = 0x5
  54:../src/intcontroller.c **** 		// (0x1 << 2) = 100
  55:../src/intcontroller.c **** 		// 111 | 100 = 111
  56:../src/intcontroller.c **** 		// (0x1 << 1) = 010 => ~(0x1 << 1) = 101
  57:../src/intcontroller.c **** 		// 111 & 101 = 101
  58:../src/intcontroller.c **** 		conf = conf | (0x1 << 2);
 1796              		.loc 1 58 0
 1797 00ac 10301BE5 		ldr	r3, [fp, #-16]
 1798 00b0 043083E3 		orr	r3, r3, #4
 1799 00b4 10300BE5 		str	r3, [fp, #-16]
  59:../src/intcontroller.c **** 		conf = conf & ~(0x1 << 1);
 1800              		.loc 1 59 0
 1801 00b8 10301BE5 		ldr	r3, [fp, #-16]
 1802 00bc 0230C3E3 		bic	r3, r3, #2
 1803 00c0 10300BE5 		str	r3, [fp, #-16]
 1804              	.L8:
  60:../src/intcontroller.c **** 	}
  61:../src/intcontroller.c **** 
  62:../src/intcontroller.c **** 	if (st == ENABLE)
 1805              		.loc 1 62 0
 1806 00c4 15305BE5 		ldrb	r3, [fp, #-21]	@ zero_extendqisi2
 1807 00c8 010053E3 		cmp	r3, #1
 1808 00cc 0300001A 		bne	.L9
  63:../src/intcontroller.c **** 		//COMPLETAR: habilitar la linea IRQ
  64:../src/intcontroller.c **** 		// bit[2] = 1
  65:../src/intcontroller.c **** 		// bit[1] = 0
  66:../src/intcontroller.c **** 		// bit[0] = 1
  67:../src/intcontroller.c **** 		conf = conf & ~(0x1 << 1);
 1809              		.loc 1 67 0
 1810 00d0 10301BE5 		ldr	r3, [fp, #-16]
 1811 00d4 0230C3E3 		bic	r3, r3, #2
 1812 00d8 10300BE5 		str	r3, [fp, #-16]
 1813 00dc 020000EA 		b	.L10
 1814              	.L9:
  68:../src/intcontroller.c **** 	else
  69:../src/intcontroller.c **** 		//COMPLETAR: deshabilitar la linea IRQ
  70:../src/intcontroller.c **** 		conf = conf | (0x1 << 1);
 1815              		.loc 1 70 0
 1816 00e0 10301BE5 		ldr	r3, [fp, #-16]
 1817 00e4 023083E3 		orr	r3, r3, #2
 1818 00e8 10300BE5 		str	r3, [fp, #-16]
 1819              	.L10:
  71:../src/intcontroller.c **** 
  72:../src/intcontroller.c **** 	rINTCON = conf;
 1820              		.loc 1 72 0
 1821 00ec 1E36A0E3 		mov	r3, #31457280
 1822 00f0 10201BE5 		ldr	r2, [fp, #-16]
 1823 00f4 002083E5 		str	r2, [r3, #0]
  73:../src/intcontroller.c **** 	return 0;
 1824              		.loc 1 73 0
 1825 00f8 0030A0E3 		mov	r3, #0
 1826              	.L6:
  74:../src/intcontroller.c **** }
 1827              		.loc 1 74 0
 1828 00fc 0300A0E1 		mov	r0, r3
 1829 0100 0CD04BE2 		sub	sp, fp, #12
 1830 0104 00689DE8 		ldmfd	sp, {fp, sp, lr}
 1831 0108 1EFF2FE1 		bx	lr
 1832              		.cfi_endproc
 1833              	.LFE1:
 1835              		.align	2
 1836              		.global	ic_conf_fiq
 1838              	ic_conf_fiq:
 1839              	.LFB2:
  75:../src/intcontroller.c **** 
  76:../src/intcontroller.c **** int ic_conf_fiq(enum enable st)
  77:../src/intcontroller.c **** {
 1840              		.loc 1 77 0
 1841              		.cfi_startproc
 1842              		@ Function supports interworking.
 1843              		@ args = 0, pretend = 0, frame = 16
 1844              		@ frame_needed = 1, uses_anonymous_args = 0
 1845 010c 0DC0A0E1 		mov	ip, sp
 1846              	.LCFI4:
 1847              		.cfi_def_cfa_register 12
 1848 0110 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 1849 0114 04B04CE2 		sub	fp, ip, #4
 1850              		.cfi_offset 14, -8
 1851              		.cfi_offset 13, -12
 1852              		.cfi_offset 11, -16
 1853              	.LCFI5:
 1854              		.cfi_def_cfa 11, 4
 1855 0118 10D04DE2 		sub	sp, sp, #16
 1856 011c 0030A0E1 		mov	r3, r0
 1857 0120 15304BE5 		strb	r3, [fp, #-21]
  78:../src/intcontroller.c **** 	int ret = 0;
 1858              		.loc 1 78 0
 1859 0124 0030A0E3 		mov	r3, #0
 1860 0128 10300BE5 		str	r3, [fp, #-16]
  79:../src/intcontroller.c **** 
  80:../src/intcontroller.c **** 	if (st == ENABLE)
 1861              		.loc 1 80 0
 1862 012c 15305BE5 		ldrb	r3, [fp, #-21]	@ zero_extendqisi2
 1863 0130 010053E3 		cmp	r3, #1
 1864 0134 0300001A 		bne	.L12
  81:../src/intcontroller.c **** 		//COMPLETAR: habilitar la linea FIQ
  82:../src/intcontroller.c **** 		// la línea FIQ es el bit menos significativo
  83:../src/intcontroller.c **** 		// para habilitar tiene que estar a 0
  84:../src/intcontroller.c **** 		ret = ret & ~(0x1 << 0);
 1865              		.loc 1 84 0
 1866 0138 10301BE5 		ldr	r3, [fp, #-16]
 1867 013c 0130C3E3 		bic	r3, r3, #1
 1868 0140 10300BE5 		str	r3, [fp, #-16]
 1869 0144 080000EA 		b	.L13
 1870              	.L12:
  85:../src/intcontroller.c **** 	else if (st == DISABLE)
 1871              		.loc 1 85 0
 1872 0148 15305BE5 		ldrb	r3, [fp, #-21]	@ zero_extendqisi2
 1873 014c 000053E3 		cmp	r3, #0
 1874 0150 0300001A 		bne	.L14
  86:../src/intcontroller.c **** 		//COMPLETAR: deshabilitar la linea FIQ
  87:../src/intcontroller.c **** 		ret = ret | (0x1 << 0);
 1875              		.loc 1 87 0
 1876 0154 10301BE5 		ldr	r3, [fp, #-16]
 1877 0158 013083E3 		orr	r3, r3, #1
 1878 015c 10300BE5 		str	r3, [fp, #-16]
 1879 0160 010000EA 		b	.L13
 1880              	.L14:
  88:../src/intcontroller.c **** 	// es necesario poner el << 0? supongo que no
  89:../src/intcontroller.c **** 	else
  90:../src/intcontroller.c **** 		ret = -1;
 1881              		.loc 1 90 0
 1882 0164 0030E0E3 		mvn	r3, #0
 1883 0168 10300BE5 		str	r3, [fp, #-16]
 1884              	.L13:
  91:../src/intcontroller.c **** 
  92:../src/intcontroller.c **** 	return ret;
 1885              		.loc 1 92 0
 1886 016c 10301BE5 		ldr	r3, [fp, #-16]
  93:../src/intcontroller.c **** }
 1887              		.loc 1 93 0
 1888 0170 0300A0E1 		mov	r0, r3
 1889 0174 0CD04BE2 		sub	sp, fp, #12
 1890 0178 00689DE8 		ldmfd	sp, {fp, sp, lr}
 1891 017c 1EFF2FE1 		bx	lr
 1892              		.cfi_endproc
 1893              	.LFE2:
 1895              		.align	2
 1896              		.global	ic_conf_line
 1898              	ic_conf_line:
 1899              	.LFB3:
  94:../src/intcontroller.c **** 
  95:../src/intcontroller.c **** int ic_conf_line(enum int_line line, enum int_mode mode)
  96:../src/intcontroller.c **** {
 1900              		.loc 1 96 0
 1901              		.cfi_startproc
 1902              		@ Function supports interworking.
 1903              		@ args = 0, pretend = 0, frame = 16
 1904              		@ frame_needed = 1, uses_anonymous_args = 0
 1905 0180 0DC0A0E1 		mov	ip, sp
 1906              	.LCFI6:
 1907              		.cfi_def_cfa_register 12
 1908 0184 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 1909 0188 04B04CE2 		sub	fp, ip, #4
 1910              		.cfi_offset 14, -8
 1911              		.cfi_offset 13, -12
 1912              		.cfi_offset 11, -16
 1913              	.LCFI7:
 1914              		.cfi_def_cfa 11, 4
 1915 018c 10D04DE2 		sub	sp, sp, #16
 1916 0190 0020A0E1 		mov	r2, r0
 1917 0194 0130A0E1 		mov	r3, r1
 1918 0198 15204BE5 		strb	r2, [fp, #-21]
 1919 019c 16304BE5 		strb	r3, [fp, #-22]
  97:../src/intcontroller.c **** 	unsigned int bit = INT_BIT(line);
 1920              		.loc 1 97 0
 1921 01a0 15305BE5 		ldrb	r3, [fp, #-21]	@ zero_extendqisi2
 1922 01a4 0120A0E3 		mov	r2, #1
 1923 01a8 1233A0E1 		mov	r3, r2, asl r3
 1924 01ac 10300BE5 		str	r3, [fp, #-16]
  98:../src/intcontroller.c **** 
  99:../src/intcontroller.c **** 	if (line < 0 || line > 26)
 1925              		.loc 1 99 0
 1926 01b0 15305BE5 		ldrb	r3, [fp, #-21]	@ zero_extendqisi2
 1927 01b4 1A0053E3 		cmp	r3, #26
 1928 01b8 0100009A 		bls	.L16
 100:../src/intcontroller.c **** 		return -1;
 1929              		.loc 1 100 0
 1930 01bc 0030E0E3 		mvn	r3, #0
 1931 01c0 1D0000EA 		b	.L17
 1932              	.L16:
 101:../src/intcontroller.c **** 
 102:../src/intcontroller.c **** 	if (mode != IRQ && mode != FIQ)
 1933              		.loc 1 102 0
 1934 01c4 16305BE5 		ldrb	r3, [fp, #-22]	@ zero_extendqisi2
 1935 01c8 000053E3 		cmp	r3, #0
 1936 01cc 0400000A 		beq	.L18
 1937              		.loc 1 102 0 is_stmt 0 discriminator 1
 1938 01d0 16305BE5 		ldrb	r3, [fp, #-22]	@ zero_extendqisi2
 1939 01d4 010053E3 		cmp	r3, #1
 1940 01d8 0100000A 		beq	.L18
 103:../src/intcontroller.c **** 		return -1;
 1941              		.loc 1 103 0 is_stmt 1
 1942 01dc 0030E0E3 		mvn	r3, #0
 1943 01e0 150000EA 		b	.L17
 1944              	.L18:
 104:../src/intcontroller.c **** 	/*
 105:../src/intcontroller.c **** 	INTMOD Interrupt Mode Register (0x01E00008). Registro con un bit por línea: a ’0’
 106:../src/intcontroller.c **** 	para que active IRQ o a ’1’ para que active FIQ.
 107:../src/intcontroller.c **** 	*/
 108:../src/intcontroller.c **** 	if (mode == IRQ)
 1945              		.loc 1 108 0
 1946 01e4 16305BE5 		ldrb	r3, [fp, #-22]	@ zero_extendqisi2
 1947 01e8 000053E3 		cmp	r3, #0
 1948 01ec 0900001A 		bne	.L19
 109:../src/intcontroller.c **** 		//COMPLETAR: poner la linea line en modo IRQ
 110:../src/intcontroller.c **** 		rINTMOD = rINTMOD & ~(0x1 << line);
 1949              		.loc 1 110 0
 1950 01f0 54309FE5 		ldr	r3, .L21
 1951 01f4 50209FE5 		ldr	r2, .L21
 1952 01f8 001092E5 		ldr	r1, [r2, #0]
 1953 01fc 15205BE5 		ldrb	r2, [fp, #-21]	@ zero_extendqisi2
 1954 0200 0100A0E3 		mov	r0, #1
 1955 0204 1022A0E1 		mov	r2, r0, asl r2
 1956 0208 0220E0E1 		mvn	r2, r2
 1957 020c 022001E0 		and	r2, r1, r2
 1958 0210 002083E5 		str	r2, [r3, #0]
 1959 0214 070000EA 		b	.L20
 1960              	.L19:
 111:../src/intcontroller.c **** 
 112:../src/intcontroller.c **** 	else
 113:../src/intcontroller.c **** 		//COMPLETAR: poner la linea line en modo FIQ
 114:../src/intcontroller.c **** 		rINTMOD = rINTMOD | (0x1 << line);
 1961              		.loc 1 114 0
 1962 0218 2C309FE5 		ldr	r3, .L21
 1963 021c 28209FE5 		ldr	r2, .L21
 1964 0220 001092E5 		ldr	r1, [r2, #0]
 1965 0224 15205BE5 		ldrb	r2, [fp, #-21]	@ zero_extendqisi2
 1966 0228 0100A0E3 		mov	r0, #1
 1967 022c 1022A0E1 		mov	r2, r0, asl r2
 1968 0230 022081E1 		orr	r2, r1, r2
 1969 0234 002083E5 		str	r2, [r3, #0]
 1970              	.L20:
 115:../src/intcontroller.c **** 
 116:../src/intcontroller.c **** 	return 0;
 1971              		.loc 1 116 0
 1972 0238 0030A0E3 		mov	r3, #0
 1973              	.L17:
 117:../src/intcontroller.c **** }
 1974              		.loc 1 117 0
 1975 023c 0300A0E1 		mov	r0, r3
 1976 0240 0CD04BE2 		sub	sp, fp, #12
 1977 0244 00689DE8 		ldmfd	sp, {fp, sp, lr}
 1978 0248 1EFF2FE1 		bx	lr
 1979              	.L22:
 1980              		.align	2
 1981              	.L21:
 1982 024c 0800E001 		.word	31457288
 1983              		.cfi_endproc
 1984              	.LFE3:
 1986              		.align	2
 1987              		.global	ic_enable
 1989              	ic_enable:
 1990              	.LFB4:
 118:../src/intcontroller.c **** 
 119:../src/intcontroller.c **** int ic_enable(enum int_line line)
 120:../src/intcontroller.c **** {
 1991              		.loc 1 120 0
 1992              		.cfi_startproc
 1993              		@ Function supports interworking.
 1994              		@ args = 0, pretend = 0, frame = 8
 1995              		@ frame_needed = 1, uses_anonymous_args = 0
 1996 0250 0DC0A0E1 		mov	ip, sp
 1997              	.LCFI8:
 1998              		.cfi_def_cfa_register 12
 1999 0254 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 2000 0258 04B04CE2 		sub	fp, ip, #4
 2001              		.cfi_offset 14, -8
 2002              		.cfi_offset 13, -12
 2003              		.cfi_offset 11, -16
 2004              	.LCFI9:
 2005              		.cfi_def_cfa 11, 4
 2006 025c 08D04DE2 		sub	sp, sp, #8
 2007 0260 0030A0E1 		mov	r3, r0
 2008 0264 0D304BE5 		strb	r3, [fp, #-13]
 121:../src/intcontroller.c **** 	if (line < 0 || line > 26)
 2009              		.loc 1 121 0
 2010 0268 0D305BE5 		ldrb	r3, [fp, #-13]	@ zero_extendqisi2
 2011 026c 1A0053E3 		cmp	r3, #26
 2012 0270 0100009A 		bls	.L24
 122:../src/intcontroller.c **** 		return -1;
 2013              		.loc 1 122 0
 2014 0274 0030E0E3 		mvn	r3, #0
 2015 0278 090000EA 		b	.L25
 2016              	.L24:
 123:../src/intcontroller.c **** 
 124:../src/intcontroller.c **** 	//COMPLETAR: habilitar las interrupciones por la linea line
 125:../src/intcontroller.c **** 	/*
 126:../src/intcontroller.c **** 	INTMSK Interrupt Mask Register (0x01E0000C). Registro con 28 bits. El bit 27 está
 127:../src/intcontroller.c **** 	reservado. El bit 26 permite enmascarar todas las líneas (máscara global). El resto
 128:../src/intcontroller.c **** 	de los bits, uno por línea, cuando toman valor ’0’ habilitan la interrupción de la línea
 129:../src/intcontroller.c **** 	correspondiente y cuando toman valor ’1’ la enmascaran.
 130:../src/intcontroller.c **** 	*/
 131:../src/intcontroller.c **** 	rINTMSK = rINTMSK & ~(0x1 << line);
 2017              		.loc 1 131 0
 2018 027c 30309FE5 		ldr	r3, .L26
 2019 0280 2C209FE5 		ldr	r2, .L26
 2020 0284 001092E5 		ldr	r1, [r2, #0]
 2021 0288 0D205BE5 		ldrb	r2, [fp, #-13]	@ zero_extendqisi2
 2022 028c 0100A0E3 		mov	r0, #1
 2023 0290 1022A0E1 		mov	r2, r0, asl r2
 2024 0294 0220E0E1 		mvn	r2, r2
 2025 0298 022001E0 		and	r2, r1, r2
 2026 029c 002083E5 		str	r2, [r3, #0]
 132:../src/intcontroller.c **** 	// se llama desde fuera con el valor line = 26
 133:../src/intcontroller.c **** 	//rINTMSK = rINTMSK & ~(0x1 << 26);
 134:../src/intcontroller.c **** 
 135:../src/intcontroller.c **** 	return 0;
 2027              		.loc 1 135 0
 2028 02a0 0030A0E3 		mov	r3, #0
 2029              	.L25:
 136:../src/intcontroller.c **** }
 2030              		.loc 1 136 0
 2031 02a4 0300A0E1 		mov	r0, r3
 2032 02a8 0CD04BE2 		sub	sp, fp, #12
 2033 02ac 00689DE8 		ldmfd	sp, {fp, sp, lr}
 2034 02b0 1EFF2FE1 		bx	lr
 2035              	.L27:
 2036              		.align	2
 2037              	.L26:
 2038 02b4 0C00E001 		.word	31457292
 2039              		.cfi_endproc
 2040              	.LFE4:
 2042              		.align	2
 2043              		.global	ic_disable
 2045              	ic_disable:
 2046              	.LFB5:
 137:../src/intcontroller.c **** 
 138:../src/intcontroller.c **** int ic_disable(enum int_line line)
 139:../src/intcontroller.c **** {
 2047              		.loc 1 139 0
 2048              		.cfi_startproc
 2049              		@ Function supports interworking.
 2050              		@ args = 0, pretend = 0, frame = 8
 2051              		@ frame_needed = 1, uses_anonymous_args = 0
 2052 02b8 0DC0A0E1 		mov	ip, sp
 2053              	.LCFI10:
 2054              		.cfi_def_cfa_register 12
 2055 02bc 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 2056 02c0 04B04CE2 		sub	fp, ip, #4
 2057              		.cfi_offset 14, -8
 2058              		.cfi_offset 13, -12
 2059              		.cfi_offset 11, -16
 2060              	.LCFI11:
 2061              		.cfi_def_cfa 11, 4
 2062 02c4 08D04DE2 		sub	sp, sp, #8
 2063 02c8 0030A0E1 		mov	r3, r0
 2064 02cc 0D304BE5 		strb	r3, [fp, #-13]
 140:../src/intcontroller.c **** 	if (line < 0 || line > 26)
 2065              		.loc 1 140 0
 2066 02d0 0D305BE5 		ldrb	r3, [fp, #-13]	@ zero_extendqisi2
 2067 02d4 1A0053E3 		cmp	r3, #26
 2068 02d8 0100009A 		bls	.L29
 141:../src/intcontroller.c **** 		return -1;
 2069              		.loc 1 141 0
 2070 02dc 0030E0E3 		mvn	r3, #0
 2071 02e0 080000EA 		b	.L30
 2072              	.L29:
 142:../src/intcontroller.c **** 
 143:../src/intcontroller.c **** 	//COMPLETAR: enmascarar las interrupciones por la linea line
 144:../src/intcontroller.c **** 	rINTMSK = rINTMSK | (0x1 << line);
 2073              		.loc 1 144 0
 2074 02e4 2C309FE5 		ldr	r3, .L31
 2075 02e8 28209FE5 		ldr	r2, .L31
 2076 02ec 001092E5 		ldr	r1, [r2, #0]
 2077 02f0 0D205BE5 		ldrb	r2, [fp, #-13]	@ zero_extendqisi2
 2078 02f4 0100A0E3 		mov	r0, #1
 2079 02f8 1022A0E1 		mov	r2, r0, asl r2
 2080 02fc 022081E1 		orr	r2, r1, r2
 2081 0300 002083E5 		str	r2, [r3, #0]
 145:../src/intcontroller.c **** 	
 146:../src/intcontroller.c **** 	return 0;
 2082              		.loc 1 146 0
 2083 0304 0030A0E3 		mov	r3, #0
 2084              	.L30:
 147:../src/intcontroller.c **** }
 2085              		.loc 1 147 0
 2086 0308 0300A0E1 		mov	r0, r3
 2087 030c 0CD04BE2 		sub	sp, fp, #12
 2088 0310 00689DE8 		ldmfd	sp, {fp, sp, lr}
 2089 0314 1EFF2FE1 		bx	lr
 2090              	.L32:
 2091              		.align	2
 2092              	.L31:
 2093 0318 0C00E001 		.word	31457292
 2094              		.cfi_endproc
 2095              	.LFE5:
 2097              		.align	2
 2098              		.global	ic_cleanflag
 2100              	ic_cleanflag:
 2101              	.LFB6:
 148:../src/intcontroller.c **** 
 149:../src/intcontroller.c **** int ic_cleanflag(enum int_line line)
 150:../src/intcontroller.c **** {
 2102              		.loc 1 150 0
 2103              		.cfi_startproc
 2104              		@ Function supports interworking.
 2105              		@ args = 0, pretend = 0, frame = 16
 2106              		@ frame_needed = 1, uses_anonymous_args = 0
 2107 031c 0DC0A0E1 		mov	ip, sp
 2108              	.LCFI12:
 2109              		.cfi_def_cfa_register 12
 2110 0320 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 2111 0324 04B04CE2 		sub	fp, ip, #4
 2112              		.cfi_offset 14, -8
 2113              		.cfi_offset 13, -12
 2114              		.cfi_offset 11, -16
 2115              	.LCFI13:
 2116              		.cfi_def_cfa 11, 4
 2117 0328 10D04DE2 		sub	sp, sp, #16
 2118 032c 0030A0E1 		mov	r3, r0
 2119 0330 15304BE5 		strb	r3, [fp, #-21]
 151:../src/intcontroller.c **** 	int bit;
 152:../src/intcontroller.c **** 
 153:../src/intcontroller.c **** 	if (line < 0 || line > 26)
 2120              		.loc 1 153 0
 2121 0334 15305BE5 		ldrb	r3, [fp, #-21]	@ zero_extendqisi2
 2122 0338 1A0053E3 		cmp	r3, #26
 2123 033c 0100009A 		bls	.L34
 154:../src/intcontroller.c **** 		return -1;
 2124              		.loc 1 154 0
 2125 0340 0030E0E3 		mvn	r3, #0
 2126 0344 1B0000EA 		b	.L35
 2127              	.L34:
 155:../src/intcontroller.c **** 
 156:../src/intcontroller.c **** 	bit = INT_BIT(line);
 2128              		.loc 1 156 0
 2129 0348 15305BE5 		ldrb	r3, [fp, #-21]	@ zero_extendqisi2
 2130 034c 0120A0E3 		mov	r2, #1
 2131 0350 1233A0E1 		mov	r3, r2, asl r3
 2132 0354 10300BE5 		str	r3, [fp, #-16]
 157:../src/intcontroller.c **** 
 158:../src/intcontroller.c **** 	if (rINTMOD & bit)
 2133              		.loc 1 158 0
 2134 0358 68309FE5 		ldr	r3, .L38
 2135 035c 002093E5 		ldr	r2, [r3, #0]
 2136 0360 10301BE5 		ldr	r3, [fp, #-16]
 2137 0364 033002E0 		and	r3, r2, r3
 2138 0368 000053E3 		cmp	r3, #0
 2139 036c 0800000A 		beq	.L36
 159:../src/intcontroller.c **** 		//COMPLETAR: borrar el flag de interrupcion correspondiente a la linea line
 160:../src/intcontroller.c **** 		//con la linea configurada por FIQ
 161:../src/intcontroller.c **** 		// se borra poniendo un 1
 162:../src/intcontroller.c **** 		rF_ISPC = rF_ISPC | (0x1 << line);
 2140              		.loc 1 162 0
 2141 0370 54309FE5 		ldr	r3, .L38+4
 2142 0374 50209FE5 		ldr	r2, .L38+4
 2143 0378 001092E5 		ldr	r1, [r2, #0]
 2144 037c 15205BE5 		ldrb	r2, [fp, #-21]	@ zero_extendqisi2
 2145 0380 0100A0E3 		mov	r0, #1
 2146 0384 1022A0E1 		mov	r2, r0, asl r2
 2147 0388 022081E1 		orr	r2, r1, r2
 2148 038c 002083E5 		str	r2, [r3, #0]
 2149 0390 070000EA 		b	.L37
 2150              	.L36:
 163:../src/intcontroller.c **** 
 164:../src/intcontroller.c **** 	else
 165:../src/intcontroller.c **** 		//COMPLETAR: borrar el flag de interrupcion correspondiente a la linea line
 166:../src/intcontroller.c **** 		//con la linea configurada por IRQ
 167:../src/intcontroller.c **** 		rI_ISPC = rI_ISPC | (0x1 << line);
 2151              		.loc 1 167 0
 2152 0394 34309FE5 		ldr	r3, .L38+8
 2153 0398 30209FE5 		ldr	r2, .L38+8
 2154 039c 001092E5 		ldr	r1, [r2, #0]
 2155 03a0 15205BE5 		ldrb	r2, [fp, #-21]	@ zero_extendqisi2
 2156 03a4 0100A0E3 		mov	r0, #1
 2157 03a8 1022A0E1 		mov	r2, r0, asl r2
 2158 03ac 022081E1 		orr	r2, r1, r2
 2159 03b0 002083E5 		str	r2, [r3, #0]
 2160              	.L37:
 168:../src/intcontroller.c **** 	return 0;
 2161              		.loc 1 168 0
 2162 03b4 0030A0E3 		mov	r3, #0
 2163              	.L35:
 169:../src/intcontroller.c **** }
 2164              		.loc 1 169 0
 2165 03b8 0300A0E1 		mov	r0, r3
 2166 03bc 0CD04BE2 		sub	sp, fp, #12
 2167 03c0 00689DE8 		ldmfd	sp, {fp, sp, lr}
 2168 03c4 1EFF2FE1 		bx	lr
 2169              	.L39:
 2170              		.align	2
 2171              	.L38:
 2172 03c8 0800E001 		.word	31457288
 2173 03cc 3C00E001 		.word	31457340
 2174 03d0 2400E001 		.word	31457316
 2175              		.cfi_endproc
 2176              	.LFE6:
 2178              	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 intcontroller.c
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1701   .text:00000000 $a
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1704   .text:00000000 ic_init
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1740   .text:0000003c $d
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1745   .text:00000044 $a
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1748   .text:00000044 ic_conf_irq
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1838   .text:0000010c ic_conf_fiq
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1898   .text:00000180 ic_conf_line
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1982   .text:0000024c $d
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1986   .text:00000250 $a
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:1989   .text:00000250 ic_enable
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:2038   .text:000002b4 $d
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:2042   .text:000002b8 $a
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:2045   .text:000002b8 ic_disable
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:2093   .text:00000318 $d
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:2097   .text:0000031c $a
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:2100   .text:0000031c ic_cleanflag
C:\Users\estib\AppData\Local\Temp\cc7fMMyk.s:2172   .text:000003c8 $d
                     .debug_frame:00000010 $d

NO UNDEFINED SYMBOLS
